# frozen_string_literal: true

class VulnerabilityPackageManager < Mongoid::Migration
  def self.up
    Vulnerability.each do |vulnerability|
      ecosystem = vulnerability.package_ecosystem
      vulnerability.update_attributes!(
        package_manager: Dependabot::Ecosystem::PACKAGE_ECOSYSTEM_MAPPING.fetch(ecosystem, ecosystem)
      )
    end
  end

  def self.down; end
end
